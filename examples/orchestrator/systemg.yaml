version: "1"

services:
  orchestrator:
    command: >-
      porki run
      --role orchestrator
      --instructions instructions/INSTRUCTIONS.md
      --redis-url redis://127.0.0.1:6379
      --log-level INFO
      --heartbeat-interval 300
      --instruction-interval 300
      --llm-provider claude
    restart_policy: always
    backoff: "5s"
    work_dir: "."
    env:
      vars:
        PORKI_LLM_MAX_CONCURRENCY: "6"
        PORKI_LLM_CONCURRENCY_WAIT_SECONDS: "900"
    spawn:
      mode: dynamic
      limits:
        children: 20
        depth: 5
        descendants: 100
        termination_policy: cascade
