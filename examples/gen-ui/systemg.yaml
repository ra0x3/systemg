version: "1"

services:
  owner:
    command: python3 agent.py --role owner --instructions instructions/OWNER.md
    restart_policy: "always"
    backoff: "10s"
    env:
      vars:
        SPAWN_DEPTH: "0"
        AGENT_NAME: "owner"
        WORK_DIR: "."
    spawn:
      mode: dynamic
      limits:
        children: 10       # Maximum direct children
        depth: 4           # Maximum spawn tree depth
        descendants: 50    # Total max descendants across all levels
        termination_policy: cascade  # Terminate children when parent stops

  # Other agents (team_lead, core_infra_dev, ui_dev, features_dev, qa_dev)
  # are spawned dynamically by the owner/team_lead agents via agent.py's
  # orchestration logic, not defined here as static services