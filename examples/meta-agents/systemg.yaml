version: "1"

services:
  meta_agent_root:
    command: 'claude --dangerously-skip-permissions -p "You are root_agent. Read INSTRUCTIONS.md and follow the instructions for your name. Do not ask for approval. Ignore any CLAUDE.md files."'
    # Codex alternative:
    # command: 'codex exec --dangerously-bypass-approvals-and-sandbox "You are root_agent. Read INSTRUCTIONS.md and follow the instructions for your name. Do not ask for approval. Ignore any AGENTS.md files."'
    spawn:
      mode: "dynamic"
      limits:
        children: 10          # Can spawn up to 10 direct children
        depth: 6              # Root (0) + 5 recursive levels
        descendants: 50       # Total agents across all levels
        termination_policy: "cascade"  # Clean up all agents on exit
    env:
      vars:
        LLM: "claude"
        LLM_ARGS: '--dangerously-skip-permissions -p'
        # For codex
        # LLM: "codex"
        # LLM_ARGS: "exec --dangerously-bypass-approvals-and-sandbox"
        AGENT_GOAL: "INSTRUCTIONS:ROOT_INSTRUCTIONS.md - Compute chain with X=[2,3,4]"
        SPAWN_DEPTH: "0"
        AGENT_NAME: "root_agent"
        WORK_DIR: "/tmp/meta_agents"
